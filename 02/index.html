<html>
	<head>
		<style>
			body {
				background-color: black;
			}
		</style>

		<script type="text/javascript" src="https://get.goXTK.com/xtk_edge.js"> </script>

		<script type="text/javascript" src="https://matte0-0.github.io/cs460student/02/loader.js"></script>

		<script>

			var SIZE = 20;  // default edge length of XTK cubes
			var GAP = 5;  // arbitrary -- 5 seems to match the assignment image

			var SELECTED_CUBE = 0;  // will hold cube picked by mouse location

			var isCameraRotating = false;
			
			window.onload = function() {

				// once everything is done loading

				r = new X.renderer3D();
				r.init();

				for (var z=-5; z < 6; z++) {
					for (var y=-5; y < 6; y++) {
						for(var x=-5; x < 6; x++) {
							new_cube = new X.cube();
							new_cube.transform.translateX((SIZE + GAP) * x);
							new_cube.transform.translateY((SIZE + GAP) * y);
							new_cube.transform.translateZ((SIZE + GAP) * z);
							r.add(new_cube);
						}
					}
				}

				r.camera.position = [0, 0, 300];

				r.render();

				r.interactor.onMouseMove = function(event) {
					cubeid = r.pick(event.offsetX, event.offsetY);
					if (cubeid != 0) {
						SELECTED_CUBE = r.get(cubeid);
						//console.log(SELECTED_CUBE)
					}
				}

				r.onRender = function() {
					// spin the camera in X direction by 1 degree
					if (isCameraRotating) {
						r.camera.rotate([1, 0]);
					}
				}

			}

			window.onkeypress = function(e) {
				if (e.key == 'q') {
					SELECTED_CUBE.visible = false;
				}
				else if (e.key == 'w') {
					SELECTED_CUBE.color = [Math.random(), Math.random(), Math.random()];
				}
				else if (e.key == 'e') {
					SELECTED_CUBE.transform.rotateX(10);
				}
				else if (e.key == 'b') {
					isCameraRotating = !isCameraRotating;
				}
				else if (e.key == 'o') {
					download();
				}
				else if (e.key == 'l') {
					upload("scene.json");
				}
			}

		</script>
	</head>
	<body>
	</body>
</html>