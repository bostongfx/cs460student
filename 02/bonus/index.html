<html>
  <head>

      <style>
        body {
            background-color: black;
        }
      </style>

      <script type="text/javascript" src="https://get.goXTK.com/xtk_edge.js"></script>
      <script type="text/javascript" src="loader.js"></script>

      <script>

          window.onload = function() {

            // creating all of the spheres
            GAP = 25;
            min = 1;
            max = 15;
              r = new X.renderer3D();
              r.init();
                for (var z=-5; z < 6; z++) {
                    for (var y=-5; y < 6; y++) {
                        for(var x=-5; x < 6; x++) {
                            SIZE = min + Math.random() * (max - min); // random size for the spheres

                            new_sphere = new X.sphere();

                            new_sphere.radius = SIZE; // set random size

                            new_sphere.transform.translateX(GAP * x);
                            new_sphere.transform.translateY(GAP * y);
                            new_sphere.transform.translateZ(GAP * z);
                            
                            
                            new_sphere.color = [Math.random(), Math.random(), Math.random()]; // random color for each sphere

                            r.add(new_sphere);
                        }
                    }
                }

                // moving camera further back and zooming out
                r.camera.position = [0, 0, 300]; 

                // picking a cube when the mouse moves over it
                var SELECTED_SPHERE = (0,0);
                r.interactor.onMouseMove = function(event) {
                cubeid = r.pick(event.offsetX, event.offsetY) ;
                if (cubeid != 0){
                    SELECTED_CUBE = r.get(cubeid);
                }
            }
                var spinning = false; // boolean variable to control spinning state (switched on/off with 'b' key) made it a 
                // global variable because i had issues having it inside the if statement

                CAMERAS = []; // list of the different camera positions
                camPos = -1; // variable to keep track of the current camera position index
                camView = null; // timer variable for cycling through camera positions

                window.onkeypress = function(e) {
                    if (e.key == 'q') { // hiding a cube when 'q' is pressed
                        SELECTED_CUBE.visible = false;
                    } 
                    
                    else if (e.key == 'w') { // changing the color of a cube when 'w' is pressed
                        if (SELECTED_CUBE != null) {
                            SELECTED_CUBE.color = [Math.random(), Math.random(), Math.random()];
                        }
                    }
                    
                    else if (e.key == 'e') { // rotating a cube when 'e' is pressed
                        SELECTED_CUBE.transform.rotateX(10);
                    }

                    else if (e.key == 'b'){ // when the button 'b' is pressed the cube will start to spin and wont stop until the button 'b' is pressed again
                    spinning = !spinning; // sets the boolean state to true so the cubes can start spinning or stopped if pressed again
                }
                    else if (e.key == 'o'){
                        // download = r.exportJSON(); // downloads the current scene as a JSON file when 'o' is pressed
                        download();
                    }
                    else if (e.key == 'l'){
                        upload('scene.json'); // uploads the scene when 'l' is pressed
                    }
                    else if (e.key == 'c'){ // saves the current camera position when 'c' is pressed
                        CAMERAS.push(r.camera.view.slice()); // clones the current camera position and adds it to the CAMERAS array
                        if (camPos == -1)
                            camPos = 0;
                    }
                    else if (e.key == 'v') {
                        if (camView) { // if timer is running, stop it
                            clearInterval(camView);
                            camView = null;
                        } 
                    else if (CAMERAS.length > 0) {
                        // if there are any saved views, start cycling through them every second
                        camView = setInterval(function() {
                            camPos = (camPos + 1) % CAMERAS.length;
                            r.camera.view = CAMERAS[camPos].slice(0);
                            }, 1000); // 1000 for 1 second intervals
                        }
                    }

                    r.onRender = function() {   
                        if (spinning) {
                            r.camera.rotate([1, 0]);
                        }
                    }

                }

              r.render();
            
  }

      </script>

  </head>
  <body>
  </body>
</html>